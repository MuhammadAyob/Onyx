
<div style="padding-left: 2em; padding-right: 2em; padding-top: 9em;height:100vh;background-image: url('../../assets/gradient.gif');background-repeat: no-repeat;background-size: 100% 25%;">
    <!-- Mat Card Form for Read Departments -->
   
  
  
  <div class="container-fluid">
    <form>
      <mat-card class="matCard">
       
        <mat-card-header class="cardHeader" style="margin-bottom: -15px; text-align: center">
            <mat-card-title-group style="margin:0 auto">
              <mat-card-title style="font-weight: 500; "
                >Select a date range to proceed</mat-card-title
              >
            </mat-card-title-group>
           
          </mat-card-header>
          <br>
          <br>
      
          <div>
            <div class="chips-container" style="display: flex; flex-direction: column; align-items: center;">
              <mat-form-field appearance="legacy">
                <mat-label style="color: #0e1a3c">Start Date</mat-label>
                <input matInput [matDatepicker]="startDatePicker" [formControl]="startFormControl" [(ngModel)]="startDate" name="startDate" required>
                <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #startDatePicker></mat-datepicker>
                <mat-error *ngIf="startFormControl.hasError('required')">
                  Start Date is <strong>required</strong>
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="legacy">
                <mat-label style="color: #0e1a3c">End Date</mat-label>
                <input matInput [matDatepicker]="endDatePicker" [formControl]="endFormControl" [(ngModel)]="endDate" name="endDate" required>
                <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #endDatePicker></mat-datepicker>
                <mat-error *ngIf="endFormControl.hasError('required')">
                  End Date is <strong>required</strong>
                </mat-error>
              </mat-form-field>
              
              <div style="display: flex; gap: 16px; margin-top: 16px;">
                <button id="confirm" class="btn" (click)="onSubmit()">Generate</button>
                <button [disabled]="!fetched" id="confirm" class="btn" (click)="downloadExcel()">Export to Excel</button>
                 <!--<button id="confirm" class="btn">Export to Excel</button>--> 
              </div>
            </div>
            
            <br>
            <mat-card-content style="padding-top: 1em;">
              <div *ngIf="isLoading" 
              style="
              display: flex;
              align-items: center;
              justify-content: center;">
                <mat-spinner ></mat-spinner>
              </div>
      <div id="htmlData" *ngIf="fetched">
     
        <div class="bigDiv" style="margin-bottom: 0px;">
            <div class="leftSearch">
              <form class="navbar-form">
                <mat-form-field appearance="outline" color="white" style="width: 100%; border-color: white !important; color: #ffffff; padding-top: 1%;">
                  <mat-label style=" color: #ffffff; background-color: transparent; border-bottom: none; font-size: 15px; width: 100%;">Search Audit Log</mat-label>
                  <input type="text" style="border-color: #5090d000;" matInput name="searchDept" (keydown.enter)="doFilter($event)" placeholder="Ex. Login">
                  <mat-icon class="search" style="float: right; margin-top: -22px;">search</mat-icon>
                </mat-form-field>
              </form>
            </div>
          </div>
        <div class="table-hover table-container mat-elevation-z8">
          <table *ngIf="!isLoading" mat-table matSort [dataSource]="dataSource"  class="mat-elevation-z8" id="DeptTable">
            <!-- Department ID Column -->
  
            <ng-container matColumnDef="Username">
              <th mat-header-cell *matHeaderCellDef style="color: #ffffff;">Username</th>
              <td mat-cell *matCellDef="let e">
                {{e.User}}
              </td>
            </ng-container>
  
            <!-- Department Name Column -->
            <ng-container matColumnDef="Date">
              <th mat-header-cell *matHeaderCellDef style="color: #ffffff;">Date</th>
              <td mat-cell *matCellDef="let e">
                {{ e.Date}}
              </td>
            </ng-container>
  
            <ng-container matColumnDef="AuditName">
              <th mat-header-cell *matHeaderCellDef style="color: #ffffff;">Audit Name</th>
              <td mat-cell *matCellDef="let e">
                {{ e.AuditName}}
              </td>
            </ng-container>
  
            <ng-container matColumnDef="Description">
              <th mat-header-cell *matHeaderCellDef style="color: #ffffff;">Description</th>
              <td mat-cell *matCellDef="let e">
                {{ e.Description}}
              </td>
            </ng-container>
  
         
  
            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  
          </table>
        
          <div *ngIf="isLoading" 
          style="
          display: flex;
          align-items: center;
          justify-content: center;">
            <mat-spinner ></mat-spinner>
          </div>
          <div *ngIf="!isLoading">
            <div *ngIf="noData | async" class="no-records" style="text-align: center; padding-top: 4em; font-size: larger;">
              No records retrieved!
            </div>
            <br>
            <br>
           </div>
      
        </div>
      </div>
            
             
            </mat-card-content>
            
          </div>
        <br>
        <br>
      
        <mat-paginator  style="color: white;" [pageSize]="5" [pageSizeOptions]="[5, 10, 15, 20]"></mat-paginator>
       
      </mat-card>
    </form>
    </div>
    <br />
  </div>
  
  